build_test:
  extends: .defaults
  stage: build_test
  needs:
    - check-code-lint
  before_script:
    - .\build.bat --clean --release
    - .\build.bat --clean --debug
  script:
    - .\build.bat --release
    - .\tools\ci\testing\windows-x86_64\step.bat
    - .\repo.bat package --mode main_package --platform windows-x86_64 --config release
  # Artifacts required to make the publishing step work
  artifacts:
    when: on_success
    paths:
    - _build/packages
