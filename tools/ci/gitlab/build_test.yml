build_test:
  extends: .defaults
  stage: build_test
  needs:
    - check-code-lint
  before_script:
    - If (Test-Path ".\portable\"){ Remove-Item ".\portable\" -Recurse -Force }
    - .\build.bat --clean --release
  script:
    - .\build.bat --release
    - .\tools\ci\testing\windows-x86_64\step.bat
  artifacts:
    when: always
    name: $CI_JOB_NAME-$CI_COMMIT_SHORT_SHA-$CI_JOB_ID
    paths:
      - .\_testoutput\
